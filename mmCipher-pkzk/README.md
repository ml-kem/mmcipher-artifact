#   mmCipher-pkzk

We show how to create and verify LNP22 Zero-Knowledge proofs for mmCipher
public keys (this counters attacks using maliciously crafted public keys.)
We use the [LaZer](https://eprint.iacr.org/2024/1846.pdf) implementation
of LNP22 scheme (see below for references).

The ZK proofs show that the (s,e) secret variables are sampled from the 
appropriate distribution; either binary {0, 1} or ternary {-1, 0, +1}.
The ternary case is handled by converting s and e into two binary vectors
(one for positive and another for negative coefficients), so the ternary
case has a double-wide witness.

Here are representative numbers with authors laptop (Ryzen 7 7840U.)

| Parameter Set | Dist.	| Proof Size    | Proof time    | Verify time   |
|---------------|-------|---------------|---------------|---------------|
| mmCipher-128  | tern	| 26473 bytes   | 0.078226 sec  | 0.040559 sec  |
| mmCipher-192  | bin	| 25261 bytes   | 0.075551 sec  | 0.042586 sec  |
| mmCipher-256  | bin	| 28022 bytes	| 0.105433 sec  | 0.056101 sec  |

Note that mmCipher-KEM and mmCipher-PKE have the same parameter sets
(keypairs are interchangeable) so these apply to both.

##  Building and Running

By defaul the code assumes that the 
[https://github.com/lazer-crypto/lazer](https://github.com/lazer-crypto/lazer)
repository is available at
`../../lazer`, and that C code for mmCipher is at `../mmCipher-c`.
Please modify the `Makefile` and the shell scripts if you need to change this.

```
mmCipher-pkzk
├── Makefile              # for running the test
├── mm_proof.c            # test code for mmCipher with LaZer
├── mm_128_param.py       # mmCipher-128 params (LaZer input)
├── mm_128_param.h        # (autogenerated from .py)
├── mm_192_param.py       # mmCipher-192 params (LaZer input)
├── mm_192_param.h        # (autogenerated from .py)
├── mm_256_param.py       # mmCipher-256 params (LaZer input)
├── mm_256_param.h        # (autogenerated from .py)
├── run_lazer.sh          # run LaZer code generator to recreate param.h files
├── proof_sizes.sh        # script to benchmark the the proof system
├── proof.log             # example output from proof_sizes.sh
└── README.md             # this file
```

If everything is set up, you can run `proof_sizes.sh` to create a report
`proof.log` about the proof sizes. Note that there is no need to re-create
the header files.


##  References

**LNP22:** Vadim Lyubashevsky, Ngoc Khanh Nguyen, and Maxime Plançon.
"Lattice-Based Zero-Knowledge Proofs and Applications: Shorter, Simpler,
and More General."
[CRYPTO 2022](https://doi.org/10.1007/978-3-031-15979-4_3)
also [IACR ePrint 2022/284](https://eprint.iacr.org/2022/284)

**LaZer:** Vadim Lyubashevsky, Gregor Seiler, Patrick Steuer.
"The LaZer Library: Lattice-Based Zero Knowledge and Succinct Proofs for
Quantum-Safe Privacy."
[ACM CCS 2024](https://doi.org/10.1145/3658644.3690330),
also [IACR ePrint 2024/1846](https://eprint.iacr.org/2024/1846).
